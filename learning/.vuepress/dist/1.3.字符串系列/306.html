<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>KMP（上篇） | 小浩算法</title>
    <meta name="generator" content="VuePress 1.4.1">
    
    <meta name="description" content="和小浩一起学算法">
    <link rel="preload" href="/assets/css/0.styles.9ca2b61f.css" as="style"><link rel="preload" href="/assets/js/app.e2b8fa5c.js" as="script"><link rel="preload" href="/assets/js/4.54b78bf5.js" as="script"><link rel="preload" href="/assets/js/1.7d73e1ec.js" as="script"><link rel="preload" href="/assets/js/3.405cb1d3.js" as="script"><link rel="prefetch" href="/assets/js/10.e0b8c49b.js"><link rel="prefetch" href="/assets/js/100.71d5ecb6.js"><link rel="prefetch" href="/assets/js/101.eee63711.js"><link rel="prefetch" href="/assets/js/102.55d0cb83.js"><link rel="prefetch" href="/assets/js/103.3ec46175.js"><link rel="prefetch" href="/assets/js/104.d27f675f.js"><link rel="prefetch" href="/assets/js/105.d7ceba02.js"><link rel="prefetch" href="/assets/js/106.acaf08c1.js"><link rel="prefetch" href="/assets/js/107.88156c64.js"><link rel="prefetch" href="/assets/js/108.2f73e8a1.js"><link rel="prefetch" href="/assets/js/109.faf935da.js"><link rel="prefetch" href="/assets/js/11.82afa120.js"><link rel="prefetch" href="/assets/js/110.fc1cf27e.js"><link rel="prefetch" href="/assets/js/111.2521be33.js"><link rel="prefetch" href="/assets/js/112.c60355fa.js"><link rel="prefetch" href="/assets/js/113.8a2c0d43.js"><link rel="prefetch" href="/assets/js/114.9133a60a.js"><link rel="prefetch" href="/assets/js/115.876b06dc.js"><link rel="prefetch" href="/assets/js/116.0507409d.js"><link rel="prefetch" href="/assets/js/117.4d75eb96.js"><link rel="prefetch" href="/assets/js/118.5ecf1131.js"><link rel="prefetch" href="/assets/js/119.05aaae74.js"><link rel="prefetch" href="/assets/js/12.c91672d5.js"><link rel="prefetch" href="/assets/js/120.c5b701e3.js"><link rel="prefetch" href="/assets/js/121.69753711.js"><link rel="prefetch" href="/assets/js/122.63d86812.js"><link rel="prefetch" href="/assets/js/123.6bf94e7d.js"><link rel="prefetch" href="/assets/js/124.2c04d5ed.js"><link rel="prefetch" href="/assets/js/125.dae9510e.js"><link rel="prefetch" href="/assets/js/126.b897c930.js"><link rel="prefetch" href="/assets/js/127.3c1e0228.js"><link rel="prefetch" href="/assets/js/13.8b88dcbf.js"><link rel="prefetch" href="/assets/js/14.168d7583.js"><link rel="prefetch" href="/assets/js/15.eb714af1.js"><link rel="prefetch" href="/assets/js/16.4350692d.js"><link rel="prefetch" href="/assets/js/17.b9e444cf.js"><link rel="prefetch" href="/assets/js/18.777e7ada.js"><link rel="prefetch" href="/assets/js/19.87dbe463.js"><link rel="prefetch" href="/assets/js/20.1b1ce662.js"><link rel="prefetch" href="/assets/js/21.5330b659.js"><link rel="prefetch" href="/assets/js/22.751097e9.js"><link rel="prefetch" href="/assets/js/23.a7bcde24.js"><link rel="prefetch" href="/assets/js/24.281f9edc.js"><link rel="prefetch" href="/assets/js/25.643fe370.js"><link rel="prefetch" href="/assets/js/26.39de823a.js"><link rel="prefetch" href="/assets/js/27.66093a0e.js"><link rel="prefetch" href="/assets/js/28.6437e3e0.js"><link rel="prefetch" href="/assets/js/29.fc8a7331.js"><link rel="prefetch" href="/assets/js/30.019b90f7.js"><link rel="prefetch" href="/assets/js/31.252cb005.js"><link rel="prefetch" href="/assets/js/32.09b2a156.js"><link rel="prefetch" href="/assets/js/33.de06b422.js"><link rel="prefetch" href="/assets/js/34.2477a1e5.js"><link rel="prefetch" href="/assets/js/35.b8a6b459.js"><link rel="prefetch" href="/assets/js/36.a576e173.js"><link rel="prefetch" href="/assets/js/37.f66ba3cd.js"><link rel="prefetch" href="/assets/js/38.28f444ad.js"><link rel="prefetch" href="/assets/js/39.a4ecc565.js"><link rel="prefetch" href="/assets/js/40.b4710b92.js"><link rel="prefetch" href="/assets/js/41.de5df3e2.js"><link rel="prefetch" href="/assets/js/42.9ce52f1f.js"><link rel="prefetch" href="/assets/js/43.cc935510.js"><link rel="prefetch" href="/assets/js/44.aa82a8ef.js"><link rel="prefetch" href="/assets/js/45.308197a4.js"><link rel="prefetch" href="/assets/js/46.2e7c9ee4.js"><link rel="prefetch" href="/assets/js/47.5add939a.js"><link rel="prefetch" href="/assets/js/48.5773e413.js"><link rel="prefetch" href="/assets/js/49.ce9a72db.js"><link rel="prefetch" href="/assets/js/5.ac596411.js"><link rel="prefetch" href="/assets/js/50.715a12c5.js"><link rel="prefetch" href="/assets/js/51.d2c164a4.js"><link rel="prefetch" href="/assets/js/52.138d6e9d.js"><link rel="prefetch" href="/assets/js/53.052e35bd.js"><link rel="prefetch" href="/assets/js/54.27092f93.js"><link rel="prefetch" href="/assets/js/55.82187afc.js"><link rel="prefetch" href="/assets/js/56.5e6fed0a.js"><link rel="prefetch" href="/assets/js/57.ca7cd96a.js"><link rel="prefetch" href="/assets/js/58.c85a9198.js"><link rel="prefetch" href="/assets/js/59.b0c3be29.js"><link rel="prefetch" href="/assets/js/6.9d44eeb3.js"><link rel="prefetch" href="/assets/js/60.6a556d9b.js"><link rel="prefetch" href="/assets/js/61.21073b19.js"><link rel="prefetch" href="/assets/js/62.e08e9348.js"><link rel="prefetch" href="/assets/js/63.f8abca53.js"><link rel="prefetch" href="/assets/js/64.1728ce32.js"><link rel="prefetch" href="/assets/js/65.91695191.js"><link rel="prefetch" href="/assets/js/66.cd05794a.js"><link rel="prefetch" href="/assets/js/67.5366b7a3.js"><link rel="prefetch" href="/assets/js/68.25f9db17.js"><link rel="prefetch" href="/assets/js/69.56ccb500.js"><link rel="prefetch" href="/assets/js/7.1850882c.js"><link rel="prefetch" href="/assets/js/70.51572475.js"><link rel="prefetch" href="/assets/js/71.70e158f7.js"><link rel="prefetch" href="/assets/js/72.af7e1095.js"><link rel="prefetch" href="/assets/js/73.d8920180.js"><link rel="prefetch" href="/assets/js/74.18b8450c.js"><link rel="prefetch" href="/assets/js/75.a640c292.js"><link rel="prefetch" href="/assets/js/76.cb3e391a.js"><link rel="prefetch" href="/assets/js/77.d2c8e10b.js"><link rel="prefetch" href="/assets/js/78.f6987552.js"><link rel="prefetch" href="/assets/js/79.6ae32026.js"><link rel="prefetch" href="/assets/js/8.cb530e31.js"><link rel="prefetch" href="/assets/js/80.e7e8ebda.js"><link rel="prefetch" href="/assets/js/81.65140f29.js"><link rel="prefetch" href="/assets/js/82.154e9eba.js"><link rel="prefetch" href="/assets/js/83.09191e62.js"><link rel="prefetch" href="/assets/js/84.7155dbc0.js"><link rel="prefetch" href="/assets/js/85.41496216.js"><link rel="prefetch" href="/assets/js/86.ad8a1ea5.js"><link rel="prefetch" href="/assets/js/87.c0c21a1d.js"><link rel="prefetch" href="/assets/js/88.3c06c1dc.js"><link rel="prefetch" href="/assets/js/89.dc7b2d6f.js"><link rel="prefetch" href="/assets/js/9.4aa8aaeb.js"><link rel="prefetch" href="/assets/js/90.6f49bf17.js"><link rel="prefetch" href="/assets/js/91.d20dff4e.js"><link rel="prefetch" href="/assets/js/92.2b29456e.js"><link rel="prefetch" href="/assets/js/93.d66b344b.js"><link rel="prefetch" href="/assets/js/94.86fe33e7.js"><link rel="prefetch" href="/assets/js/95.015011f3.js"><link rel="prefetch" href="/assets/js/96.11feee99.js"><link rel="prefetch" href="/assets/js/97.8b830a67.js"><link rel="prefetch" href="/assets/js/98.9d1b91e1.js"><link rel="prefetch" href="/assets/js/99.7a4a82e9.js">
    <link rel="stylesheet" href="/assets/css/0.styles.9ca2b61f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container" data-v-19557b78><div data-v-19557b78><div id="loader-wrapper" class="loading-wrapper" data-v-d48f4d20 data-v-19557b78 data-v-19557b78><div class="loader-main" data-v-d48f4d20><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div></div> <!----> <!----></div> <div class="password-shadow password-wrapper-out" style="display:none;" data-v-64685f0e data-v-19557b78 data-v-19557b78><h3 class="title" style="display:none;" data-v-64685f0e data-v-64685f0e>小浩算法</h3> <!----> <label id="box" class="inputBox" style="display:none;" data-v-64685f0e data-v-64685f0e><input type="password" value="" data-v-64685f0e> <span data-v-64685f0e>Konck! Knock!</span> <button data-v-64685f0e>OK</button></label> <div class="footer" style="display:none;" data-v-64685f0e data-v-64685f0e><span data-v-64685f0e><i class="iconfont reco-theme" data-v-64685f0e></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-64685f0e>vuePress-theme-reco</a></span> <span data-v-64685f0e><i class="iconfont reco-copyright" data-v-64685f0e></i> <a data-v-64685f0e><span data-v-64685f0e>程序员小浩</span>
            
          <span data-v-64685f0e>2019 - </span>
          2020
        </a></span></div></div> <div class="hide" data-v-19557b78><header class="navbar" data-v-19557b78><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">小浩算法</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://github.com/geekxh/hello-algorithm" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-19557b78></div> <aside class="sidebar" data-v-19557b78><div class="personal-info-wrapper" data-v-b038cec6><img src="/code.png" alt="author-avatar" class="personal-img" data-v-b038cec6> <h3 class="name" data-v-b038cec6>
    程序员小浩
  </h3> <div class="num" data-v-b038cec6><div data-v-b038cec6><h3 data-v-b038cec6>0</h3> <h6 data-v-b038cec6>Article</h6></div> <div data-v-b038cec6><h3 data-v-b038cec6>0</h3> <h6 data-v-b038cec6>Tag</h6></div></div> <hr data-v-b038cec6></div> <nav class="nav-links"><div class="nav-item"><a href="https://github.com/geekxh/hello-algorithm" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>学习须知</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/0.0.学习须知/01.html" class="sidebar-link">小浩算法</a></li><li><a href="/0.0.学习须知/02.html" class="sidebar-link">阅读指南</a></li><li><a href="/0.0.学习须知/021.html" class="sidebar-link">指导学习（一）</a></li><li><a href="/0.0.学习须知/022.html" class="sidebar-link">指导学习（二）</a></li><li><a href="/0.0.学习须知/023.html" class="sidebar-link">指导学习（三）</a></li><li><a href="/0.0.学习须知/03.html" class="sidebar-link">资源下载</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>数组系列</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/1.0.数组系列/001.html" class="sidebar-link">两个数组的交集(350)</a></li><li><a href="/1.0.数组系列/002.html" class="sidebar-link">最长公共前缀(14)</a></li><li><a href="/1.0.数组系列/003.html" class="sidebar-link">买卖股票的最佳时机(122)</a></li><li><a href="/1.0.数组系列/004.html" class="sidebar-link">旋转数组(189)</a></li><li><a href="/1.0.数组系列/005.html" class="sidebar-link">原地删除(27)</a></li><li><a href="/1.0.数组系列/006.html" class="sidebar-link">加一(66)</a></li><li><a href="/1.0.数组系列/007.html" class="sidebar-link">两数之和(1)</a></li><li><a href="/1.0.数组系列/008.html" class="sidebar-link">三数之和（15）</a></li><li><a href="/1.0.数组系列/009.html" class="sidebar-link">Z字形变换（6）</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>链表系列</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/1.1.链表系列/101.html" class="sidebar-link">删除链表倒数第N个节点(19)</a></li><li><a href="/1.1.链表系列/102.html" class="sidebar-link">合并两个有序链表(21)</a></li><li><a href="/1.1.链表系列/103.html" class="sidebar-link">环形链表(21)</a></li><li><a href="/1.1.链表系列/104.html" class="sidebar-link">两数相加（2）</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>动态规划系列</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/1.2.动态规划系列/201.html" class="sidebar-link">爬楼梯(70)</a></li><li><a href="/1.2.动态规划系列/202.html" class="sidebar-link">最大子序和(53)</a></li><li><a href="/1.2.动态规划系列/203.html" class="sidebar-link">最长上升子序列(300)</a></li><li><a href="/1.2.动态规划系列/204.html" class="sidebar-link">三角形最小路径和(120)</a></li><li><a href="/1.2.动态规划系列/205.html" class="sidebar-link">最小路径和(64)</a></li><li><a href="/1.2.动态规划系列/206.html" class="sidebar-link">打家劫舍(198)</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>字符串系列</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/1.3.字符串系列/301.html" class="sidebar-link">反转字符串(301)</a></li><li><a href="/1.3.字符串系列/302.html" class="sidebar-link">字符串中的第一个唯一字符(387)</a></li><li><a href="/1.3.字符串系列/303.html" class="sidebar-link">实现 Sunday 匹配</a></li><li><a href="/1.3.字符串系列/304.html" class="sidebar-link">大数打印</a></li><li><a href="/1.3.字符串系列/305.html" class="sidebar-link">验证回文串（125）</a></li><li><a href="/1.3.字符串系列/306.html" class="active sidebar-link">KMP（上篇）</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/1.3.字符串系列/306.html#_01、图解分析" class="sidebar-link">01、图解分析</a></li><li class="sidebar-sub-header"><a href="/1.3.字符串系列/306.html#_02、总结" class="sidebar-link">02、总结</a></li></ul></li><li><a href="/1.3.字符串系列/307.html" class="sidebar-link">旋转字符串（796）</a></li><li><a href="/1.3.字符串系列/308.html" class="sidebar-link">最后一个单词的长度（58）</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>二叉树系列</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/1.4.二叉树系列/401.html" class="sidebar-link">最大深度与DFS(104)</a></li><li><a href="/1.4.二叉树系列/402.html" class="sidebar-link">层次遍历与BFS(102)</a></li><li><a href="/1.4.二叉树系列/403.html" class="sidebar-link">BST与其验证(98)</a></li><li><a href="/1.4.二叉树系列/404.html" class="sidebar-link">BST 的查找(700)</a></li><li><a href="/1.4.二叉树系列/405.html" class="sidebar-link">BST 的删除(450)</a></li><li><a href="/1.4.二叉树系列/406.html" class="sidebar-link">平衡二叉树(110)</a></li><li><a href="/1.4.二叉树系列/407.html" class="sidebar-link">完全二叉树(222)</a></li><li><a href="/1.4.二叉树系列/408.html" class="sidebar-link">二叉树的剪枝(814)</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>回溯系列</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/1.41.回溯系列/1.html" class="sidebar-link">全排列算法</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>滑动窗口系列</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/1.5.滑动窗口系列/501.html" class="sidebar-link">滑动窗口最大值（239）</a></li><li><a href="/1.5.滑动窗口系列/502.html" class="sidebar-link">无重复字符的最长子串（3）</a></li><li><a href="/1.5.滑动窗口系列/503.html" class="sidebar-link">字母异位词（438）</a></li><li><a href="/1.5.滑动窗口系列/504.html" class="sidebar-link">和为s的连续正数序列</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>博弈论系列</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/1.6.博弈论系列/601.html" class="sidebar-link">囚徒困境</a></li><li><a href="/1.6.博弈论系列/602.html" class="sidebar-link">辛普森悖论</a></li><li><a href="/1.6.博弈论系列/603.html" class="sidebar-link">红眼睛和蓝眼睛</a></li><li><a href="/1.6.博弈论系列/604.html" class="sidebar-link">海盗分金币</a></li><li><a href="/1.6.博弈论系列/605.html" class="sidebar-link">智猪博弈</a></li><li><a href="/1.6.博弈论系列/606.html" class="sidebar-link">生男生女的问题</a></li><li><a href="/1.6.博弈论系列/607.html" class="sidebar-link">硬币问题</a></li><li><a href="/1.6.博弈论系列/608.html" class="sidebar-link">画圈圈的问题</a></li><li><a href="/1.6.博弈论系列/609.html" class="sidebar-link">巧克力问题</a></li><li><a href="/1.6.博弈论系列/610.html" class="sidebar-link">大鱼和小鱼的问题</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>排序类题目</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/1.7.排序类题目/701.html" class="sidebar-link">按奇偶排序数组（905）</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>位运算系列</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/1.8.位运算系列/801.html" class="sidebar-link">使用位运算求和</a></li><li><a href="/1.8.位运算系列/802.html" class="sidebar-link">2的幂(231)</a></li><li><a href="/1.8.位运算系列/803.html" class="sidebar-link">返回二进制中1的个数(191)</a></li><li><a href="/1.8.位运算系列/804.html" class="sidebar-link">只出现一次的数字(136)</a></li><li><a href="/1.8.位运算系列/805.html" class="sidebar-link">只出现一次的数字Ⅱ(137)</a></li><li><a href="/1.8.位运算系列/806.html" class="sidebar-link">缺失数字(268)</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>二分法系列</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/1.9.二分法系列/901.html" class="sidebar-link">爱吃香蕉的珂珂（875）</a></li><li><a href="/1.9.二分法系列/902.html" class="sidebar-link">x的平方根（69）</a></li><li><a href="/1.9.二分法系列/903.html" class="sidebar-link">第一个错误的版本（287）</a></li><li><a href="/1.9.二分法系列/904.html" class="sidebar-link">旋转排序数组中的最小值Ⅰ（153）</a></li><li><a href="/1.9.二分法系列/905.html" class="sidebar-link">旋转排序数组中的最小值Ⅱ(154)</a></li><li><a href="/1.9.二分法系列/906.html" class="sidebar-link">供暖器（475）</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>其他补充题目</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/1.99.其他补充题目/01.html" class="sidebar-link">螺旋矩阵Ⅰ（54）</a></li><li><a href="/1.99.其他补充题目/02.html" class="sidebar-link">只有两个键的键盘（650）</a></li><li><a href="/1.99.其他补充题目/03.html" class="sidebar-link">24点游戏（679）</a></li><li><a href="/1.99.其他补充题目/04.html" class="sidebar-link">飞机座位分配概率（1227）</a></li><li><a href="/1.99.其他补充题目/05.html" class="sidebar-link">水分子的产生</a></li><li><a href="/1.99.其他补充题目/06.html" class="sidebar-link">救生艇（881）</a></li><li><a href="/1.99.其他补充题目/07.html" class="sidebar-link">25匹马的经典问题</a></li><li><a href="/1.99.其他补充题目/08.html" class="sidebar-link">灯泡开关（319）</a></li><li><a href="/1.99.其他补充题目/09.html" class="sidebar-link">三门问题</a></li><li><a href="/1.99.其他补充题目/10.html" class="sidebar-link">猜数字游戏（299）</a></li><li><a href="/1.99.其他补充题目/11.html" class="sidebar-link">LRU缓存机制（146）</a></li><li><a href="/1.99.其他补充题目/12.html" class="sidebar-link">最小的k个数</a></li><li><a href="/1.99.其他补充题目/13.html" class="sidebar-link">不同路径</a></li><li><a href="/1.99.其他补充题目/14.html" class="sidebar-link">不同路径 - 障碍物</a></li><li><a href="/1.99.其他补充题目/15.html" class="sidebar-link">伪蒙特卡洛</a></li><li><a href="/1.99.其他补充题目/16.html" class="sidebar-link">盛最多水的容器</a></li><li><a href="/1.99.其他补充题目/17.html" class="sidebar-link">扑克牌中的顺子容器</a></li><li><a href="/1.99.其他补充题目/18.html" class="sidebar-link">整数拆分（343）</a></li><li><a href="/1.99.其他补充题目/19.html" class="sidebar-link">移动石子直到连续（1033）</a></li><li><a href="/1.99.其他补充题目/20.html" class="sidebar-link">Nim 游戏（292）</a></li><li><a href="/1.99.其他补充题目/21.html" class="sidebar-link">寻找两个正序数组的中位数（292）</a></li><li><a href="/1.99.其他补充题目/22.html" class="sidebar-link">第k个最大元素（215）</a></li><li><a href="/1.99.其他补充题目/23.html" class="sidebar-link">镜面反射（858）</a></li><li><a href="/1.99.其他补充题目/25.html" class="sidebar-link">整数转罗马数字（12）</a></li><li><a href="/1.99.其他补充题目/26.html" class="sidebar-link">荷兰国旗问题</a></li><li><a href="/1.99.其他补充题目/27.html" class="sidebar-link">六九问题</a></li><li><a href="/1.99.其他补充题目/28.html" class="sidebar-link">有效的数独</a></li><li><a href="/1.99.其他补充题目/29.html" class="sidebar-link">费米估算</a></li><li><a href="/1.99.其他补充题目/30.html" class="sidebar-link">分发饼干</a></li><li><a href="/1.99.其他补充题目/31.html" class="sidebar-link">生命游戏（289）</a></li><li><a href="/1.99.其他补充题目/32.html" class="sidebar-link">搜索二维矩阵（74）</a></li><li><a href="/1.99.其他补充题目/33.html" class="sidebar-link">子集（78）</a></li><li><a href="/1.99.其他补充题目/34.html" class="sidebar-link">面试中的智力题</a></li><li><a href="/1.99.其他补充题目/50.html" class="sidebar-link">图的基础知识</a></li><li><a href="/1.99.其他补充题目/51.html" class="sidebar-link">旋转图像（48）</a></li><li><a href="/1.99.其他补充题目/52.html" class="sidebar-link">螺旋矩阵Ⅱ（59）</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>排序系列</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/2.0.排序系列/0.hello.html" class="sidebar-link">排序专栏</a></li><li><a href="/2.0.排序系列/1.bubbleSort.html" class="sidebar-link">冒泡排序</a></li><li><a href="/2.0.排序系列/10.radixSort.html" class="sidebar-link">基数排序</a></li><li><a href="/2.0.排序系列/2.selectionSort.html" class="sidebar-link">选择排序</a></li><li><a href="/2.0.排序系列/3.insertionSort.html" class="sidebar-link">插入排序</a></li><li><a href="/2.0.排序系列/4.shellSort.html" class="sidebar-link">希尔排序</a></li><li><a href="/2.0.排序系列/5.mergeSort.html" class="sidebar-link">归并排序</a></li><li><a href="/2.0.排序系列/6.quickSort.html" class="sidebar-link">快速排序</a></li><li><a href="/2.0.排序系列/7.heapSort.html" class="sidebar-link">堆排序</a></li><li><a href="/2.0.排序系列/8.countingSort.html" class="sidebar-link">计数排序</a></li><li><a href="/2.0.排序系列/9.bucketSort.html" class="sidebar-link">桶排序</a></li></ul></section></li></ul> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-64685f0e data-v-19557b78><h3 class="title" style="display:none;" data-v-64685f0e data-v-64685f0e>KMP（上篇）</h3> <!----> <label id="box" class="inputBox" style="display:none;" data-v-64685f0e data-v-64685f0e><input type="password" value="" data-v-64685f0e> <span data-v-64685f0e>Konck! Knock!</span> <button data-v-64685f0e>OK</button></label> <div class="footer" style="display:none;" data-v-64685f0e data-v-64685f0e><span data-v-64685f0e><i class="iconfont reco-theme" data-v-64685f0e></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-64685f0e>vuePress-theme-reco</a></span> <span data-v-64685f0e><i class="iconfont reco-copyright" data-v-64685f0e></i> <a data-v-64685f0e><span data-v-64685f0e>程序员小浩</span>
            
          <span data-v-64685f0e>2019 - </span>
          2020
        </a></span></div></div> <div data-v-19557b78><main class="page"><div class="page-title" style="display:none;"><h1>KMP（上篇）</h1> <hr> <div data-v-484a899e><i class="iconfont reco-account" data-v-484a899e><span data-v-484a899e>程序员小浩</span></i> <i class="iconfont reco-date" data-v-484a899e><span data-v-484a899e>2020-07-11</span></i> <i class="iconfont reco-eye" data-v-484a899e><span id="/1.3.%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%B3%BB%E5%88%97/306.html" data-flag-title="Your Article Title" class="leancloud-visitors" data-v-484a899e><a class="leancloud-visitors-count" style="font-size:.9rem;font-weight:normal;color:#999;"></a></span></i> <!----></div></div> <div class="theme-reco-content content__default" style="display:none;"><blockquote><p>今天打算为大家讲解一下KMP。</p></blockquote> <br> <p>KMP 其实已经念念叨叨挺长时间了，一直没写的原因是我觉得自己可能写不好。<strong>与其误人子弟，宁可错失良机</strong>。毕竟自己懂是一码事，能讲清楚是另一码事。</p> <br> <p>所以为了写好这篇文章，我又去参考了很多别的资料。嗯。。<strong>我发现网上讲解 KMP 的文章实在是太多了，但大多数看完后还是云里雾里（纵然我已经会了，读对方的文章还是懵逼）</strong>。</p> <br> <p>我希望我的这篇文章能达到的目的是：<strong>让小白也能学会KMP</strong>。如果届时达到了目的，请帮我进行一次转发。否则，你只需要叉掉即可。</p> <br> <p>话不多说，我们直接开始。</p> <h2 id="_01、图解分析"><a href="#_01、图解分析" class="header-anchor">#</a> 01、图解分析</h2> <blockquote><p>KMP 算法常被称为“看毛片算法”，由一个姓K的，一个姓M的，一个姓P 一起提出。<strong>是一种由暴力匹配改进的字符串匹配算法</strong>。</p></blockquote> <br> <p>我看了下网上的 KMP 讲解基本都是由 <strong>next匹配表</strong> 开始讲起。但是说实话，如果是我第一次看这玩意，你给我讲 next匹配表，我肯定一脸懵逼。所以我打算换一种讲法。</p> <br> <p>上面说了，<strong>KMP 是由暴力匹配改进的字符串匹配算法</strong>。那什么是暴力匹配？假若我们的目标串和模式串如下图。（之前在 Sunday 匹配中讲过，<strong>所有的字符串匹配算法第一步都是对齐</strong>。不管是 暴力匹配，KMP，Sunday，BM 都是一样）</p> <img src="/assets/img/1.7628e6d5.jpg" alt="PNG" style="zoom:50%;"> <p>暴力匹配，就是目标串和模式串一个一个的对比。</p> <img src="/assets/img/2.b40d95e1.jpg" alt="PNG" style="zoom:50%;"> <p>当A匹配成功，继续开始比对，直到我们遇见一个不匹配的字符。</p> <img src="/assets/img/3.349f556b.jpg" alt="PNG" style="zoom:50%;"> <p>然后我们调整模式串，<strong>从目标串的下一个字符开始匹配（注意，这里是核心）</strong>。很遗憾，还是没有匹配成功（A和B）</p> <img src="/assets/img/4.8d02ff74.jpg" alt="PNG" style="zoom:50%;"> <p>继续这个步骤：</p> <img src="/assets/img/5.bd4d699f.jpg" alt="PNG" style="zoom:50%;"> <p>直到我们完成整个匹配过程：</p> <img src="/assets/img/6.f292572e.jpg" alt="PNG" style="zoom:50%;"> <p>假若我们目标串长度为m，模式串长度为n。模式串与目标串至少比较m次，又因其自身长度为n，所以理论的时间复杂度为**O(m*n)。**但我们可以看到，<strong>因为途中遇到不能匹配的字符时，就可以停止，并不需要完全对比（比如上图第2行）</strong>。所以虽然理论时间复杂度为 <strong>O(m*n)</strong> ，但其实大部分情况效率高很多。</p> <br> <p>暴力匹配又称为BF算法，暴风算法。代码比较简单：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token comment">//GO </span>
<span class="token keyword">func</span> <span class="token function">BFSearch</span><span class="token punctuation">(</span>haystack <span class="token builtin">string</span><span class="token punctuation">,</span> needle <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token builtin">int</span> <span class="token punctuation">{</span> 
    l1 <span class="token operator">:=</span> <span class="token function">len</span><span class="token punctuation">(</span>haystack<span class="token punctuation">)</span> 
    l2 <span class="token operator">:=</span> <span class="token function">len</span><span class="token punctuation">(</span>needle<span class="token punctuation">)</span> 
    i<span class="token punctuation">,</span> j <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span> 
    <span class="token keyword">for</span> i <span class="token operator">&lt;</span> l1 <span class="token operator">&amp;&amp;</span> j <span class="token operator">&lt;</span> l2 <span class="token punctuation">{</span> 
        <span class="token keyword">if</span> haystack<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> needle<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token punctuation">{</span> 
            i<span class="token operator">++</span> 
            j<span class="token operator">++</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            i <span class="token operator">-=</span> j <span class="token operator">-</span> <span class="token number">1</span>
            j <span class="token operator">=</span> <span class="token number">0</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> j <span class="token operator">==</span> l2 <span class="token punctuation">{</span>
        <span class="token keyword">return</span> i <span class="token operator">-</span> j
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>接下来我们开始说KMP。假如还是上面的这个串。最开始其实还是一样，我们依次对比A-A,B-B,C-C，直到遇见第一个无法匹配的字符A-E。</p> <img src="/assets/img/7.addb94af.jpg" alt="PNG" style="zoom:50%;"> <p>现在开始不一样了，如果按照上面的暴力匹配。此时目标串我们应该回到 B 这个位置，模式串应直接回到头。但是按照 KMP 的思路，<strong>在我们在第一次匹配后，因为 BC 匹配成功了，所以我们知道了 BC 不等于 A（注意这个逻辑关系）</strong>：</p> <img src="/assets/img/8.3632bf0c.jpg" alt="PNG" style="zoom:50%;"> <p>那既然已知了 BC 不等于 A，我们就没必要用 A 和 BC 进行匹配了。那我们直接用 A 越过前面不需要匹配的 BC：</p> <img src="/assets/img/9.09f2ebf9.jpg" alt="PNG" style="zoom:50%;"> <p>继续向下适配，我们发现在 D-C 处，匹配不上了。</p> <img src="/assets/img/10.f6fd1f71.jpg" alt="PNG" style="zoom:50%;"> <p>那我们因为前面的 B 又匹配成功了，那我们就知道 B 不等于 A，所以我们又可以直接略过前面的 B：</p> <img src="/assets/img/11.764c6ff1.jpg" alt="PNG" style="zoom:50%;"> <p>也就是说，我们可以直接从 D 处开始比较：</p> <img src="/assets/img/12.35e54239.jpg" alt="PNG" style="zoom:50%;"> <p>继续向下比较：</p> <img src="/assets/img/13.4a93ccb0.jpg" alt="PNG" style="zoom:50%;"> <p>到现在为止，你已经掌握了 KMP 的前百分之五十：<strong>在KMP中，如果模式串和目标串没有匹配成功，目标串不回溯</strong>。现在我们需要换一个新串，来掌握接下来的百分之五十：</p> <img src="/assets/img/14.18d289c2.jpg" alt="PNG" style="zoom:50%;"> <p>我们还是从头开始匹配，直到遇到第一个不匹配的字符：</p> <img src="/assets/img/15.9c3af63a.jpg" alt="PNG" style="zoom:50%;"> <p>到这里和上面的例子还是一样，<strong>因为我们的 BC 匹配成功了，所以我们知道 BC 不等于 A，所以我们可以跳过 BC（注意这个逻辑）</strong>：</p> <img src="/assets/img/16.e723d28e.jpg" alt="PNG" style="zoom:50%;"> <p>所以我们从 A 处开始比较：</p> <img src="/assets/img/17.6750d734.jpg" alt="PNG" style="zoom:50%;"> <p>直到我们再次匹配失败：</p> <img src="/assets/img/18.955ef13b.jpg" alt="PNG" style="zoom:50%;"> <p>我想到现在你已经知道怎么做了，来和我一起说。**因为前面的 B 匹配成功了，所以我们知道 B 不等于 A，所以我们可以跳过 B。**当然，跳过之后下一次的匹配直接失败了（A-D）。</p> <img src="/assets/img/19.99629451.jpg" alt="PNG" style="zoom:50%;"> <p>重点来了！！！然后我们继续匹配下一位。我们发现这一次，我们的匹配基本就要匹配成功了，但是卡在了最后一步的比较（D-B）。</p> <img src="/assets/img/20.21270649.jpg" alt="PNG" style="zoom:50%;"> <p>现在怎么办？假若我们把两个串修改一下（把里边的AB修改成XY），那么显而易见，你当然知道从哪里开始：</p> <img src="/assets/img/21.c71ff2d5.jpg" alt="PNG" style="zoom:50%;"> <p>但是现在的问题是，在模式串中 AB 重复出现了，那我们是不是可以在下次比较的时候直接把 AB 给让出来？</p> <img src="/assets/img/22.0dfbaa1c.jpg" alt="PNG" style="zoom:50%;"> <p>所以我们把这个AB让出来，让出来之后，我们相当于在 模式串 上又跳过了 2个字符。（也就是说模式串下一次匹配从C开始）</p> <img src="/assets/img/23.e483057b.jpg" alt="PNG" style="zoom:50%;"> <p>其实到这里 KMP 就基本完事了。我们可以稍微总结下：</p> <br> <ul><li><p>如果模式串和目标串匹配成功，长串短串都加一</p></li> <li><p>如果模式串和目标串没有匹配成功：</p></li> <li><ul><li>目标串不回溯（<strong>在上面的分割线之前，我都是给你讲这个</strong>）</li> <li>模式串回溯到匹配未成功的字符前的子串的相同的真前缀和真后缀的最大长度**（在上面的分割线之后，我重点是给你讲这个）**</li></ul></li></ul> <br> <p>好了，我知道上面匹配成功后的第二种情况有点拗口。所以我又单独拎出来和你说。这句话是啥意思呢？</p> <br> <p>假若我们有个串 abbaab：</p> <ul><li>a, ab, abb, abba, abbaa，就是它的真前缀。</li> <li>b, ab, aab, baab, bbaab, 就是它的真后缀。</li> <li>“真”字，<strong>说白了就是不包含自己</strong>。</li></ul> <br> <p>在我们上面的示例中，未成功的字符前的子串是 ABCEAB，它相同的最长的真前缀和真后缀就是 AB，最大长度就是2。所以我们就把模式串回溯到第2个位置处。</p> <img src="/assets/img/24.faeadf2e.jpg" alt="PNG" style="zoom:50%;"> <p>我猜有人要说话了，“不是说模式串是回溯到真前缀和真后缀的最大长度位置处吗？那为什么上面的第一个例子，是回到了起始位置呢？”</p> <img src="/assets/img/25.6750d734.jpg" alt="PNG" style="zoom:50%;"> <p>其实，不是我们没有回溯模式串，而是此时的最大长度（指的是相同真前缀和真后缀的最大长度，后面都省略）其实就是 0。</p> <br> <p>那我们怎么获取最大长度呢？就可以很自然的引入 next表 了。<strong>不管你是把next表 理解成描述最大长度的东东，还是把 next表 理解成用来回溯模式串的东东，其实都是可以的！！！这也是为什么你在网上看到很多人文章对next表理解不一致的原因。</strong></p> <img src="/assets/img/26.120ba786.jpg" alt="PNG" style="zoom:50%;"> <p>我们拿上面标黄色那个解释一下，ABCEAB 不包含自己，那就是 ABCEA，ABCEA的 真前缀 和 真后缀 为：</p> <br> <ul><li>A,AB,ABC,ABCE</li> <li>A,EA,CEA,BCEA</li></ul> <br> <p>所以最大长度就是 1。那这个 1 干啥用呢？我们可以在下次比的时候就直接把这个 A 让过去，直接从 B 开始比。</p> <img src="/assets/img/27.af418b95.jpg" alt="PNG" style="zoom:67%;"> <p>这里注意，如果我们模式串稍微修改成下面这样，此时 F 的最大长度就是 0，并不是 2。初学者很容易把 AB 误认为是最长相同的真前缀和真后缀。</p> <img src="/assets/img/28.0129bd8c.jpg" alt="PNG" style="zoom:67%;"> <p>到这里为止，其实 KMP 的思路已经快说完了。但是大神说话了，大神认为这个匹配表，还得再改改，不然会出问题。</p> <img src="/assets/img/29.3fdbe3a3.jpg" alt="PNG" style="zoom:67%;"> <p>为什么会出问题呢，我们说了，对 KMP 而言，**如果没有匹配成功，**<strong>目标串是不回溯的</strong>。那如果目标串不回溯，如果模式串一直都是 0，是不是意味着这个算法就没办法继续进行下去？所以大神把这个 next匹配表 改了一下，把 0 位置处的 next表 值改为了 -1。</p> <img src="/assets/img/30.fdddeb32.jpg" alt="PNG" style="zoom:67%;"> <p>那这个 -1 是干嘛用的呢？<strong>其实只是一个代码技巧</strong>！大家注意一下第 7 行代码，假若没有 j == -1，此时如果 next[j] 等于 0，是不是就进死循环了。而加上这一句，相当于说无论什么情况下，模式串的第一个字符都可以匹配（对 j 而言，此时 -1++，是不是还是0。但是此时模式串却向前走了。不就不会因为死循环而卡死了吗？<strong>请大家自行脑补没有 j==-1 这行代码时，死循环卡死在11行的过程</strong>）</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code> <span class="token comment">//GO </span>
<span class="token keyword">func</span> <span class="token function">KmpSearch</span><span class="token punctuation">(</span>haystack <span class="token builtin">string</span><span class="token punctuation">,</span> needle <span class="token builtin">string</span><span class="token punctuation">,</span> next <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token builtin">int</span> <span class="token punctuation">{</span> 
    l1 <span class="token operator">:=</span> <span class="token function">len</span><span class="token punctuation">(</span>haystack<span class="token punctuation">)</span> 
    l2 <span class="token operator">:=</span> <span class="token function">len</span><span class="token punctuation">(</span>needle<span class="token punctuation">)</span> 
    i<span class="token punctuation">,</span> j <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span> 
    <span class="token keyword">for</span> i <span class="token operator">&lt;</span> l1 <span class="token operator">&amp;&amp;</span> j <span class="token operator">&lt;</span> l2 <span class="token punctuation">{</span> 
        <span class="token keyword">if</span> j <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">||</span> haystack<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> needle<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token punctuation">{</span> 
            i<span class="token operator">++</span>
            j<span class="token operator">++</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            j <span class="token operator">=</span> next<span class="token punctuation">[</span>j<span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> j <span class="token operator">==</span> l2 <span class="token punctuation">{</span>
        <span class="token keyword">return</span> i <span class="token operator">-</span> j
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>到这里为止，其实 KMP 就讲的差不太多了，代码还是比较简单的。但是麻烦的是？一般我们并没有现成的 next表 直接使用。那 next表 又该如何生成呢？</p> <br> <p>其实 next表 的生成，我们也可以看作是字符串匹配的过程：<strong>即原模式串和原模式串自身前缀进行匹配的过程。</strong></p> <br> <p>我们用下面这个字符串来讲一下：XXYXXYXXX。</p> <img src="data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAj8AAABsCAMAAACy9yN1AAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAllBMVEX////5+fnw8PD8/Pz09PTt7e339/c1NTUrKysqKioMDAwREREpKSlOTk43NzdTU1NgYGAPDw86Ojo2NjZRUVHnplIAAAAAgsZSpuf//8aEAAAAAFKl4///x4SEx///46VSAAAAVaXn/////+elVQDn/+cAAITG///GggBSUlLGx4QtLS0NDQ1aWlpeXl5fX18iIiIkJCTIZVULAAAAAWJLR0QAiAUdSAAAAAlwSFlzAAAOxAAADsQBlSsOGwAAA3RJREFUeNrt3G1T2kAYheEABaWtFWhJBVRA0dJaa/v//1xnAkPZD7s0S8Keh9zPjIOZzGUO5JjwMiTLdtPKnGk7S+7KTiewEtkgaScpUlHaSYpUlHaSIhWlnaRIRWknKVJR2kmKVJRZazfvWs50nSV3Za8XWIlskLTTdKSitJMUqSjtJEUqSjtJkYrSTlKkorSTFKko7SRFKko7SZGK0k5SpKK0kxSpKO0kRSpKO0mRitJOUqSitJMUqSiz9m66bWcuLven7y71Aysv339AnpP8eLXfC7cm/mJ9uh5EzhB5VnJ0HTj+BPqTRc4QeVaS/iDpDzKVpD9I+oNMJekPkv4gU0n6g6Q/yFSS/iDpDzKVpD/I2vrj/db8Z1P3EVmfHH2JuX4Cxx/kZjh/IekPMpWkP0j6g0wl6Q+S/iBTSfqDpD/IVJL+IHX6M86/bm9vSiaNlpPp7Lb45W77F06wzaak/Q9Z8fFnnN8XD45vc/6mR8v5YvlQ7Jni5jTbbEraw7Li/jyuZrfZZOr73wokjZebezfe/mOfZptNSXtQBvvT2U2v44z/8/f5Yvm0ev5WPukRcj27zeaLmwhJ2mPl6Pt+L9yaxPQnG+d5ccwrnTReTqbLp5X3fFDPNpuS9pAM9ufflHj9tfafLA8804+Wd3nuPx/UtM2mpD0gK3/9Pl/kgcNdKGm8jH90SHukrLo/j6vnH7n/6VYgabwMPh2taZtNSXtIVt2fdX5f/JRPGi/j9whpj5UV96d4dTqZ+o94w+pl/B4h7dGy2v5s3x3b3pRJGi+z6D1C2uNlpf3ZFXVc9t35eLlRMXuEtBVIPj9F6nx+qnkfkfVJ+oOkP8hUkv4g6Q8yleT6CUiun4BMJTl/IekPMpWkP0j6g0wl6Q+S/iBTSfqDpD/IVJL+IOkPMpWkP0j6g0wl6Q+ytv60d9NtO3PxEjs/+8hzki9X+71wa+Iv1utgf345S29vgZWD33+Q5yRfB4Hjj//AFFjpXLcD2WBpJylSUdpJilSUdpIiFaWdpEhFaScpUlHaSYpUlHaSIhWlnaRIRWknKVJR2kmKVJR2kiIVpf/6Cd2W/1vzvV5gJbJB0k7TkYrSTlKkorSTFKko7SRFKko7SZGK0k5SpKK0kxSpKO0kRSpKO0mRitJOUqSitJMUqSjtJEUqSjtJkYryL0z9Vclt1SugAAAAAElFTkSuQmCC" alt="PNG" style="zoom:80%;"> <p>对于该字符串：</p> <br> <ul><li>真前缀为 X,XX,XXY,XXYX,XXYXX.....</li> <li>真后缀为 X,XX,XXX,YXXX,XYXXX.....</li></ul> <br> <p>为了方便大家理解，我画了两种图（左图是真实的填表过程，右图是脑补过程）：</p> <br> <ul><li><p>首先 index[0] 肯定是填写 0</p> <img src="/assets/img/32.55284143.jpg" alt="PNG" style="zoom:67%;"></li> <li><p>然后填写 index[1]。<strong>如果匹配上，我们把 i 和 j 都加一</strong>。</p> <img src="/assets/img/33.2f9c6307.jpg" alt="PNG" style="zoom:67%;"></li> <li><p>然后填写 index[2]，<strong>如果没有匹配上，就把 j 回溯到 j 当前指向的前一个位置的 index 处。在这里，也就是 0 。</strong></p> <img src="/assets/img/34.088e44cf.jpg" alt="PNG" style="zoom:67%;"></li> <li><p>注意，是回溯完成后才开始填表，此时 index[2] 为 0</p> <img src="/assets/img/35.c4d9475c.jpg" alt="PNG" style="zoom:67%;"></li> <li><p>然后我们移动 i，发现下一位匹配成功。同时给 i 和 j 加一，并填表。</p> <img src="/assets/img/36.16e8c10d.jpg" alt="PNG" style="zoom:67%;"></li> <li><p>填完表后，我们发现下一位仍然匹配。继续移动 i 和 j。</p> <img src="/assets/img/37.a96ce0dc.jpg" alt="PNG" style="zoom:67%;"> <center>（填表）</center> <img src="/assets/img/38.8d2e09fd.jpg" alt="PNG" style="zoom:67%;"> <center>（仍然匹配，继续移动 i 和 j）</center></li> <li><p>仍然匹配成功，继续重复上面的操作。</p> <img src="/assets/img/39.5bb938d3.jpg" alt="PNG" style="zoom:67%;"> <img src="/assets/img/40.02513dd2.jpg" alt="PNG" style="zoom:67%;"> <img src="/assets/img/41.278a834a.jpg" alt="PNG" style="zoom:67%;"></li> <li><p>注意，<strong>到这里开始匹配失败了</strong>。上面说了，如果没有匹配成功，<strong>把 j 回溯到 j 当前指向的前一个位置的 index 处</strong>。在这里，也就是 2 。</p> <img src="/assets/img/42.f0b0ff81.jpg" alt="PNG" style="zoom:67%;"> <img src="/assets/img/43.af5389d7.jpg" alt="PNG" style="zoom:67%;"> <center>（j 的前一个位置的 index）</center> <img src="/assets/img/44.daadc38e.jpg" alt="PNG" style="zoom:67%;"> <center>（回溯完成后，我们发现仍然不匹配）</center></li> <li><p>继续这个回溯的过程。。。（这一步是整个 next表 构建的核心）</p> <img src="/assets/img/45.1509be0f.jpg" alt="PNG" style="zoom:67%;"> <center>（这个蓝色的小标是下次的回溯位置）</center> <img src="/assets/img/46.71cd5e77.jpg" alt="PNG" style="zoom:67%;"> <center>（回溯后，我们发现匹配成功了）</center> <img src="/assets/img/47.cd5c0b80.jpg" alt="PNG" style="zoom:67%;"></li></ul> <center>（然后我们可以填表了）</center> <ul><li>注意！这里为什么是填2，其实就是填写上次回溯到的那个匹配成功的位置的index值加1。</li></ul> <br> <p>细心的读者，估计到这里发现一点问题。我们把填完后的表拿出来：</p> <img src="data:image/jpeg;base64,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" alt="PNG" style="zoom:80%;"> <p>我们发现这个表和我们最上面说的不太一样，我们最上面说的 next表 的首位是 -1，并且要记录哪一个 index 位置的 next 值，是去看该元素前面所有子串的真前缀和真后缀的最大长度。这句话有点拗口，我们还是看到下面这个。</p> <img src="/assets/img/49.b7bb9267.jpg" alt="PNG" style="zoom:67%;"> <p>比如 index 为 5 时，此时next的值是看 ABCEA 的最大长度（真后缀A，真前缀A，所以为1）。<strong>但是在我们下面这个表中，我们发现我们是记录的当前索引位置处的最大长度</strong>。其实我这里要说一下，下面这个表，其实我们一般称为<strong>部分匹配表</strong>，或者pmt。</p> <img src="data:image/jpeg;base64,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" alt="PNG" style="zoom:80%;"> <p>那这个表和我们的 next 表有什么关系吗，我们发现把这个表往后串一位，就得到了我们最终的 next 表。</p> <img src="/assets/img/51.8438f2b4.jpg" alt="PNG" style="zoom:80%;"> <p>但是但是但是！！！并不是所有讲解 KMP 的地方都会给你提一提部分匹配表的概念，有的地方干脆就直接把这个 pmt 等同于 next 表使用。**这种属于错误讲解吗？其实不是的！**因为我上面也说了，next表 在最初始位置补 -1，或者甚至干脆把 pmt 的第一位补一个 -1 当作 next表，这都统统是可以的。<strong>因为最关键的还是说你到时候怎么去使用！毕竟 next表 的定义也是人们给它赋予的！</strong></p> <br> <p>举个例子，假如你 next表 的首位不补 -1，我们其实就可以在前面 KMP 的算法中，去掉 -1 的逻辑。而单独加一个 if 判断来解决上面说的死循环的问题。</p> <h2 id="_02、总结"><a href="#_02、总结" class="header-anchor">#</a> 02、总结</h2> <p>KMP上篇到这里就结束了! KMP系列打算分上下两篇来讲，第一讲就是讲明白 KMP 是干嘛的，next 表是干嘛的，pmt 又是干嘛的。第二讲会给大家讲讲关于 next表 的计算，以及 next表 的优化。</p> <br> <p>总之，我个人认为本篇内容放在全网讲解KMP的文章里，质量都还是可以的。如果是小白，学习本篇文章其实就够了。</p> <br> <p>今天的题目到这里就结束了，你学会了吗？快来评论区留下你的想法吧！</p></div> <footer class="page-edit" style="display:none;"><!----> <div class="last-updated"><span class="prefix">文章修订于: </span> <span class="time">7/11/2020, 10:13:00 PM</span></div></footer> <!----> <!----></main> <!----></div></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-44bd5a18 data-v-44bd5a18><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-44bd5a18><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-44bd5a18></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-44bd5a18></path></svg></div><div class="notification-wrapper" data-v-34310651><h4 class="notification-title" data-v-34310651><i class="iconfont reco-tongzhi" data-v-34310651></i> <span data-v-34310651>公告</span> <i class="btn-close" data-v-34310651><svg t="1573745677073" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4448" width="22" height="22" class="icon" data-v-34310651><path d="M512 34.133333a486.4 486.4 0 1 0 486.4 486.4A486.4 486.4 0 0 0 512 34.133333z m209.4848 632.8064l-55.6032 55.466667-151.517867-151.125333-151.517866 151.1168-55.6032-55.466667 151.517866-151.108267L307.242667 364.714667l55.6032-55.466667 151.517866 151.125333 151.517867-151.1168 55.6032 55.466667-151.517867 151.099733z m0 0" p-id="4449" data-v-34310651></path></svg></i></h4> <div class="notification-content" data-v-34310651><h5 data-v-34310651>🐳 扫码回复【进群】🐳 </h5> <h5 data-v-34310651>🎉 加入每日刷题群 🎉</h5> <h5 data-v-34310651>🍓 下载高清《图解算法》🍓</h5> <br data-v-34310651> <img src="/code.png" alt data-v-34310651></div> <div style="padding: 0px 16px;" data-v-34310651><hr data-v-34310651> <a href="/0.0.学习须知/01.html" class="btn-donate" data-v-34310651> 进群 </a></div></div></div></div>
    <script src="/assets/js/app.e2b8fa5c.js" defer></script><script src="/assets/js/4.54b78bf5.js" defer></script><script src="/assets/js/1.7d73e1ec.js" defer></script><script src="/assets/js/3.405cb1d3.js" defer></script>
  </body>
</html>
